services:
  meerkat:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: meerkat
    ports:
      - "8080:8080"
    volumes:
      - ./config.json:/app/config.json:ro
      - meerkat_data:/app/data
    environment:
      - MEERKAT_API_KEY=${MEERKAT_API_KEY}
      - MEERKAT_API_PORT=8080
      - MEERKAT_DB_PATH=/app/data/observations.db
      - MEERKAT_LOG_LEVEL=${MEERKAT_LOG_LEVEL:-INFO}
      - MEERKAT_LOG_FORMAT=${MEERKAT_LOG_FORMAT:-text}
      - MEERKAT_LOG_OUTPUT=${MEERKAT_LOG_OUTPUT:-stdout}
      - MEERKAT_DEV_MODE=${MEERKAT_DEV_MODE:-false}
    command:
      - --config
      - /app/config.json
      - --db-path
      - /app/data/observations.db
    restart: unless-stopped
    healthcheck:
      test: ["CMD-SHELL", "bash -c '</dev/tcp/localhost/8080' || exit 1"]
      interval: 30s
      timeout: 5s
      retries: 3
      start_period: 10s

volumes:
  meerkat_data:

